{{ if and (ne .settings.enabled false) }}
  <meta title="mod:hall-of-mirrors" content="status:enabled">
  {{ if .page.Resources.GetMatch "*gallery*"}}
    {{ partial "modules/hall-of-mirrors/inline.js.html" }}
    {{ partial "modules/hall-of-mirrors/inline.css.html" }}
    <script>
      /*! Fetch Inject v2.0.2 | Copyright (C) 2017â€“2018 VHS <0xc000007b@tutanota.com> | @license Zlib */
      !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.fetchInject=t()}(this,function(){"use strict";const e=function(e,t,n,r,o,c,i){c=t.createElement(n),i=t.getElementsByTagName(n)[0],c.appendChild(t.createTextNode(r.text)),c.onload=o(r),i?i.parentNode.insertBefore(c,i):t.head.appendChild(c)};return function(t,n){if(!arguments.length)return Promise.reject(new ReferenceError("Failed to execute 'fetchInject': 1 argument required but only 0 present."));if(arguments[0]&&arguments[0].constructor!==Array)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 1 must be of type 'Array'."));if(arguments[1]&&arguments[1].constructor!==Promise)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 2 must be of type 'Promise'."));const r=[],o=n?[].concat(n):[],c=[];return t.forEach(e=>o.push(window.fetch(e).then(e=>[e.clone().text(),e.blob()]).then(e=>Promise.all(e).then(e=>{r.push({text:e[0],blob:e[1]})})))),Promise.all(o).then(()=>(r.forEach(t=>{c.push({then:n=>{t.blob.type.includes("text/css")?e(window,document,"style",t,n):e(window,document,"script",t,n)}})}),Promise.all(c)))}});

      fetchInject([
        {{ "modules/hall-of-mirrors/photoswipe.css" | relURL }},
        {{ "modules/hall-of-mirrors/default-skin.css" | relURL }},
        {{ "modules/hall-of-mirrors/photoswipe.min.js" | relURL }},
        {{ "modules/hall-of-mirrors/photoswipe-ui-default.min.js" | relURL }}
      ]).then(() => {
        initPhotoSwipeFromDOM('[itemtype="http://schema.org/ImageGallery"]')
      })
    </script>
  {{ end }}
{{ else }}
  <meta title="mod:hall-of-mirrors" content="status:disabled">
{{ end }}
